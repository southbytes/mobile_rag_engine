# v0.2.0 - LLM-Optimized RAG Update

This release transforms `mobile_rag_engine` from a basic semantic search tool into a complete RAG pipeline optimized for Large Language Models.

## ðŸš€ Key Features

### 1. Intelligent Chunking Strategy
- **Recursive Character Splitting**: Naturally splits text by paragraphs (`\n\n`), lines (`\n`), sentences (`. `), and words.
- **Overlap Support**: Maintains context continuity between chunks (default: 50 chars).
- **Why?** Prevents "context dilution" and fit large documents into limited LLM token windows.

### 2. New Data Architecture
- **Sources Table**: Stores original full-text documents.
- **Chunks Table**: Stores overlapping, searchable vector segments linked to the source.
- **Benefit**: Search retrieves precise segments, not overwhelming 30-page documents.

### 3. Context Builder
- Automatically assembles search results into a single context string.
- **Token Budgeting**: Ensures the context never exceeds your LLM's limit (e.g., 2000 tokens).
- **Strategies**:
  - `relevanceFirst`: Most similar chunks first.
  - `diverseSources`: Picks chunks from different documents to cover more ground.
  - `chronological`: Preserves original document order.

### 4. High-Level API (`SourceRagService`)
A unified service that handles the entire pipeline:
1.  **Add**: `addSourceWithChunking()` (Auto-chunk/embed/save)
2.  **Index**: `rebuildIndex()`
3.  **Search**: `search(query, tokenBudget: 2000)`
4.  **Prompt**: `formatPrompt(query, result)`

## ðŸ“¦ Migration Guide

**v0.1.0 Style (Deprecated but supported):**
```dart
await addDocument(content: "whole text"); // Still works, but not recommended for RAG
```

**v0.2.0 Style (Recommended):**
```dart
final rag = SourceRagService(dbPath: 'rag.db');
await rag.init();

// Auto-chunking pipeline
await rag.addSourceWithChunking(largeDocumentString);

// Search with 2000 token limit
final result = await rag.search("query", tokenBudget: 2000);

// Get ready-to-use LLM prompt
final prompt = rag.formatPrompt("query", result);
```

## ðŸ›  Fixes & Improvements
- Fixed type errors (`BigInt` vs `int`, `Float32List`) in Dart bindings.
- Improved database schema migration.
- Cleaned up unused embedding code.
